(function ($) {
   'use strict';
 
   /**
    *-------------------------------------------------------------------------------------------------------------------------------------------
    * bee_tp_dynamic : reset js section has slider or istope
    * bee_bk_flickity : reset js section has flickity, choose select on block
    * bee_tp_flickity: reset js section has flickity
    * bee_tp_istope: reset js section has istope
    * bee_tp_lb: reset js section has lookbook
    * bee_tp_tab: reset js section has tab, tab simple
    * bee_tp_tab2: reset js section has tab Accordion
    * bee_tp_tab3: reset js section has tab, tab Accordion (mobile)
    * bee_tp_parallax: reset js section has parallax
    * bee_tp_cd: reset js section has coundownt
    * bee_tp_mfps:  reset js section has mfp popup
    * bee_tp_ins:   reset js section has instagram
    *-------------------------------------------------------------------------------------------------------------------------------------------
    */
 
   // USE btoa atoa to encode base64
   // eg: btoa('#purchase_codebee') => 'I3B1cmNoYXNlX2NvZGV0NA=='
   // eg: atob('I3B1cmNoYXNlX2NvZGV0NA==') => '#purchase_codebee'
       var IsDisableConsole    = true,
       $window                 = $(window),
       $document               = $(document),
       $html                   = $('html'),
       $body                   = $('body'),
       BEEThemeSPDes           = BEEThemeSP,
       windowWidth             = $window.width(),
       str_Section_ID          = atob('I3Nob3BpZnktc2VjdGlvbi0='), // #shopify-section-'
       str_bk_flickity         = atob('YmVlX2JrX2ZsaWNraXR5'), // 'bee_bk_flickity'
       str_tp_flickity         = atob('YmVlX3RwX2ZsaWNraXR5'), // 'bee_tp_flickity'
       str_tp_istope           = atob('YmVlX3RwX2lzdG9wZQ=='), // 'bee_tp_istope'
       str_tp_tab              = atob('YmVlX3RwX3RhYg=='), // 'bee_tp_tab'
       str_tp_tab2             = atob('YmVlX3RwX3RhYjI='), // 'bee_tp_tab2'
       str_tp_tab3             = atob('YmVlX3RwX3RhYjM='), // 'bee_tp_tab3'
       str_tp_parallax         = atob('YmVlX3RwX3BhcmFsbGF4'), // 'bee_tp_parallax'
       str_tp_cd               = atob('YmVlX3RwX2Nk'), // 'bee_tp_cd'
       str_tp_mfps             = atob('YmVlX3RwX21mcHM='), // bee_tp_mfps
       str_tp_video            = atob('YmVlX3RwX3ZpZGVv'), // bee_tp_video
       str_tp_bgvideo          = atob('YmVlX3RwX2JndmlkZW8='), // bee_tp_bgvideo
       str_bee_tp_ins          = atob('YmVlX3RwX2lucw=='), // bee_tp_ins
       str_bee_tp_lb           = atob('YmVlX3RwX2xi'), // bee_tp_lb
       str_bee_tp_bundles      = atob('YmVlX3RwX2J1bmRsZXM='), // bee_tp_bundles
       str_sidebar             = atob('YmVlLXNlY3Rpb24tc2lkZWJhcg=='), // bee-section-sidebar
       str_main                = atob('YmVlLXNlY3Rpb24tbWFpbg=='), // bee-section-main
       str_header              = atob('YmVlLXNlY3Rpb24taGVhZGVy'), // bee-section-header
       str_footer              = atob('YmVlLXNlY3Rpb24tZm9vdGVy'), // bee-section-footer
       str_top_bar_id          = atob('I3Nob3BpZnktc2VjdGlvbi10b3AtYmFy'), // #shopify-section-top-bar
       str_announcement_bar_id = atob('I3Nob3BpZnktc2VjdGlvbi1hbm5vdW5jZW1lbnQtYmFy'), // #shopify-section-announcement-bar
       str_backTop             = atob('YmFja190b3A='), // back_top
 
       str_action              = atob('aXMtYWN0aW9uX19ob3Zlcg=='), // is-action__hover
       str_main_product        = atob('YmVlLXNlY3Rpb24tbWFpbi1wcm9kdWN0'), // bee-section-main-product
       str_featured_product    = atob('YmVlLXNlY3Rpb24tZmVhdHVyZWQtcHJvZHVjdA=='), // bee-section-featured-product
       str_main_qv             = atob('bWFpbi1xdg=='), // main-qv
       str_main_qs             = atob('bWFpbi1xcw=='), // main-qs
       str_color_cus           = atob('YmVlX2N1c3RvbV9jb2xvcg=='), // bee_custom_color
       str_mini_cart           = atob('bWluaV9jYXJ0'), // mini_cart 
       str_login_sidebar       = atob('bG9naW4tc2lkZWJhcg=='), // login-sidebar
       str_mb_nav              = atob('bWJfbmF2'), // mb_nav
       str_mb_cat              = atob('bWJfY2F0'), // mb_cat
       str_popups              = atob('cG9wdXBz'), // popups
       // str_facets              = atob('ZmFjZXRz'), // facets
       // str_facets_tags         = atob('ZmFjZXRzX3RhZ3M='), // facets_tags
       str_rencent_related     = atob('YmVlLXRwLXJlbmNlbnQtcmVsYXRlZA=='), // bee-tp-rencent-related
       str_rencent             = atob('aWRfcmVjZW50bHlfdmlld2Vk'), // id_recently_viewed 
       str_related             = atob('aWRfcHJvZHVjdC1yZWNvbW1lbmRhdGlvbnM='), //id_product-recommendations
       str_tp_marquee          = atob('YmVlX3RwX21hcnF1ZWU='),// bee_tp_marquee
       str_sl_fmarquee         = atob('LnQ0cy1tYXJxdWVlOm5vdCgubWFycXVlZXQ0cy1lbmFibGVkKQ=='), // .bee-marquee:not(.marqueebee-enabled)
       str_tp_btn_toogle       = atob('YmVlX3RwX2J0bl90b29nbGU='), // bee_tp_btn_toogle
       str_sl_btn_toogle       = atob('W2RhdGEtd3JhcC10b29nbGVdOm5vdCguaXMtLWVuYWJsZWQp'), // [data-wrap-toogle]:not(.is--enabled)
 
 
       
       str_sl_flickity = atob('LmZsaWNraXR5YmVlOm5vdCguZmxpY2tpdHl0NHMtbGF0ZXIpOm5vdCguZmxpY2tpdHl0NHMtZW5hYmxlZCk='), // .flickitybee:not(.flickitybee-later):not(.flickitybee-enabled)
       _flickitybee = atob('LmZsaWNraXR5YmVl'), // '.flickitybee'
       attr_sl = atob('W2RhdGEtc2VsZWN0LWZsaWNraXR5XQ=='), // '[data-select-flickity]'
       str_sl_fisotope = atob('Lmlzb3RvcGV0NHM6bm90KC5pc290b3BlYmVlLWxhdGVyKTpub3QoLmlzb3RvcGV0NHMtZW5hYmxlZCk='), // .isotopebee:not(.isotopebee-later):not(.isotopebee-enabled)
 
       SectionLoadEvt = atob('c2hvcGlmeTpzZWN0aW9uOmxvYWQ='), // shopify:section:load
       SectionUnloadEvt = atob('c2hvcGlmeTpzZWN0aW9uOnVubG9hZA=='), // shopify:section:unload
       SectionSelectEvt = atob('c2hvcGlmeTpzZWN0aW9uOnNlbGVjdA=='), // shopify:section:select
       SectionDeselectEvt = atob('c2hvcGlmeTpzZWN0aW9uOmRlc2VsZWN0'), // shopify:section:deselect
       BlockSelectEvt = atob('c2hvcGlmeTpibG9jazpzZWxlY3Q='), // shopify:block:select
       BlockDeselectEvt = atob('c2hvcGlmeTpibG9jazpkZXNlbGVjdA=='),
       Owl_select = atob('c2VsZWN0'), // select
       Owl_selectCell = atob('c2VsZWN0Q2VsbA=='), // selectCell
 
       Owl_pausePlayer = atob('cGF1c2VQbGF5ZXI='), // pausePlayer
       Owl_unpausePlayer = atob('dW5wYXVzZVBsYXllcg=='),
        
       // str_categoriesMain = atob('c2hvcGlmeS1zZWN0aW9uLWhlYWRlci1jYXRlZ29yaWVzLW1lbnU='), // shopify-section-header-categories-menu
       // str_categories     = atob('c2hvcGlmeS1zZWN0aW9uLWhlYWRlci1jYXRlZ29yaWVz'), // shopify-section-header-categories
       str_categoriesMain = atob('YmVlLWlzLWhlYWRlci1jYXRlZ29yaWVzLW1lbnU='), // bee-is-header-categories-menu
       str_categories     = atob('YmVlLWlzLWhlYWRlci1jYXRlZ29yaWVz'), // bee-is-header-categories
       // str_categories_cl  = atob('YmVlLWhlYWRlci1jYXRlZ29yaWVz'), // bee-header-categories
       str_categories_cl  = str_categories,
       $categoriessMain   = $('.'+str_categoriesMain), // $('#'+str_categoriesMain)
       $headerCategories  = $('.'+str_categories), // $('#'+str_categories)
       headerWrapperCategories  = getheaderWrapperCategories();
 
     // btoa('Hello world, Nathan, Bee Studio.')
     if (!IsDisableConsole) console.log(atob('SGVsbG8gd29ybGQsIE5hdGhhbiwgVGhlNCBTdHVkaW8u'));
 
     function Bee_console_log(txt,$se,$bk) {
       if (IsDisableConsole) return;
       console.log(txt,$se,$bk)
     };
 
     function getheaderWrapperCategories() {
      return $categoriessMain.find( atob('W2RhdGEtd3JhcHBlci1jYXRlZ29yaWVzXQ==') )[0]; // [data-wrapper-categories]
     };
 
     var flickityBlock = {
       select: function($parentSection,$bk){
         
         if ($bk.is(attr_sl)) {
           var index = $bk.index();
         } else {
           var index = $bk.closest(attr_sl).index();
         }
          $parentSection.find(_flickitybee).flickitybee( Owl_selectCell, index );
          $parentSection.find(_flickitybee).flickitybee(Owl_pausePlayer)
       },
       deselect: function($parentSection){
         $parentSection.find(_flickitybee).flickitybee(Owl_unpausePlayer)
       }
     };
 
     // flickityBlock.select($parentSection,blockId);
     // flickityBlock.deselect($parentSection)
    function JsonParse(str) {
      return JSON.parse(str || '{}');
    };
 
    var srt_section_mb_nav = 'bee-sp-section-mb-nav',
        srt_section_mb_cat = 'bee-sp-section-mb-cat',
        themeName          = BEEconfigs.theme;
 
    function sectionMobile($parentSection) {
       //console.log('sectionMobile')
       if ( !BEEconfigs.isPageIndex ) {
          return false
       } else if ( $parentSection.hasClass(srt_section_mb_nav) ) {
          return str_mb_nav
       } else if ( $parentSection.hasClass(srt_section_mb_cat) ) {
          return str_mb_cat
       } else {
          return false
       }
    };
 
    if (BEEconfigs.isPageIndex) {
       $('#shopify-'+str_mb_nav).html( $('.'+srt_section_mb_nav).html() );
       $('#shopify-'+str_mb_cat).html( $('.'+srt_section_mb_cat).html() );
    }
 
    function setCacheCatMobileMylti($parentSection, bl = true) {
 
       if ( !$parentSection.hasClass(srt_section_mb_cat) && bl ) return
 
       var $listActive = $('.bee-list-categories--item.is--active'),
       key_index       = $listActive.index(),
       key_id          = (key_index > 0) ? key_index : '',  
       key_data        = themeName+'dataMenuBeeADM'+key_id,
       $cat            = $('#MainContent .'+srt_section_mb_cat);
 
       if ( key_index == 0 || !window.sessionStorage ) return;
 
       if ( BEEconfigs.isPageIndex && $cat.length > 0 ) {
          sessionStorage.setItem( key_data, $cat.html() );
       } else {
          let dataCat = sessionStorage.getItem( key_data );
 
          if ( dataCat ) $('#shopify-'+str_mb_cat).html( dataCat || '' );
       }
 
    }
    setCacheCatMobileMylti($('body'), false);
   
   // 'shopify:section:load'
   $document.on(SectionLoadEvt, function(e){
       var id = e.detail.sectionId,
           $parentSection = $(str_Section_ID + id);
       Bee_console_log(SectionLoadEvt,$parentSection);
       
       var id2 = sectionMobile($parentSection);
       if (id2) {
           $('#shopify-'+id2).html($parentSection.html());
       }
       setCacheCatMobileMylti($parentSection);
       // Run all section
       BEEThemeSP.initVarHeight();
       BEEThemeSPDes.fullHeightFirtSe(); // Section Full height
       BEEThemeSPDes.AnimateOnScroll();
       BEEThemeSPDes.ProductItem.init();
       BEEThemeSPDes.Tooltip();
       BEEThemeSPDes.ProductItem.clickMoreSwatches();
       BEEThemeSPDes.ProductItem.swatchesClickHover();
       BEEThemeSPDes.ProductItem.resizeObserver();
       BEEThemeSPDes.initLoadMore();
 
       // End run all section
       $body.trigger('bee:hideTooltip');
 
       if ($parentSection.hasClass(str_bk_flickity) || $parentSection.hasClass(str_tp_flickity)) {
         var $owl = $parentSection.find(str_sl_flickity);
         if ($owl.length > 0) {
            //console.log(BEEThemeSPDes.Carousel)
            $owl.each(function(index) {
               this['flickitybee'+index] = new BEEThemeSPDes.Carousel(this);
            });
            //BEEThemeSPDes.Flickitybee.init($owl);
            BEEThemeSPDes.resizeEventBE(); 
            BEEThemeSP.goToID(); 
         }
       }
 
       if ( $parentSection.hasClass(str_tp_istope) ) {
         var $iso = $parentSection.find(str_sl_fisotope);
         if ($iso.length > 0) { 
          BEEThemeSPDes.Isotopebee.init($iso);
          BEEThemeSP.Isotopebee.filter();
         }
       }
 
       if ( $parentSection.hasClass(str_tp_cd) ) {
         BEEThemeSPDes.Countdown();
       }
 
       if ( $parentSection.hasClass(str_tp_mfps) ) {
         BEEThemeSPDes.PopupMFP();
       }
 
       if ( $parentSection.hasClass(str_tp_video) ) {
         BEEThemeSPDes.Video.initPoster();
         BEEThemeSPDes.PopupMFP();
       }
 
       if ( $parentSection.hasClass(str_tp_marquee) ) {
         var $el = $parentSection.find(str_sl_fmarquee);
         if ($el.length > 0) { 
           $el[0].marquee3k = new BEEThemeSP.Marquee3k($el[0]);
         }
       }
 
       if ( $parentSection.hasClass(str_tp_btn_toogle) ) {
         var $el = $parentSection.find(str_sl_btn_toogle);
         if ($el.length > 0) { 
           $el[0].btnMore = new BEEThemeSP.BtnMore($el[0]);
           $el[0].marquee3k = new BEEThemeSP.Marquee3k($el[0]);
         }
       }
 
       if ( $parentSection.hasClass(str_tp_parallax) ) {
 
          // Run Parallax
          BEEThemeSPDes.ParallaxInt();
 
          // Run Parallax BG
          $('.bee-parallax-bg:not(.lazyloadbeeed)').one('lazyloaded', function(e) {
              // console.log('parallax bg',e)
              setTimeout(function(){ 
                BEEThemeSPDes.ParallaxInt();
              }, 100);
          });
       }
 
       if ( $parentSection.hasClass(str_tp_bgvideo) ) {
         BEEThemeSPDes.BgVideo();
       }
 
       if (id == 'top-bar') {
          $html.removeClass('is-header--stuck'); 
          var options = JsonParse($parentSection.find('[data-topbar-options]').attr('data-topbar-options'));
          if (options.isTransparent) {
             $html.addClass('is--topbar-transparent');
             document.documentElement.style.setProperty('--topbar-height', document.getElementById('bee-top-bar-main').offsetHeight + 'px');
          } else {
             $html.removeClass('is--topbar-transparent');
          }
          BEEThemeSPDes.Header.stickyInit();
          //BEEThemeSPDes.Header.init();
       } else if ( id == str_backTop) {
          BackToTop();
 
       } else if ( id == str_popups ) {
          // if ($.magnificPopupBee.instance.isOpen) $.magnificPopupBee.close();
          BEEThemeSPDes.PopupPro();
       }
       
       if ( $parentSection.hasClass(str_main_product) || $parentSection.hasClass(str_featured_product) ) {
          var data_product = 'data-product-featured',
          class_enabled    = 'initProducts__enabled',
          $this            = $parentSection.find('['+data_product+']:not(.'+class_enabled+')');
 
          $this.addClass(class_enabled);
          if ( $parentSection.hasClass(str_main_product) ) $('.bee-sticky-atc').remove();
          $('.drift-bounding-box.drift-open').remove();
          var $flickitybee = $this.find('[data-main-media].flickitybee');
          if ($flickitybee.length > 0 ) $flickitybee[0].flickitybee = new BEEThemeSPDes.Carousel($flickitybee[0]);
          new BEEThemeSPDes.Product( $this );
          BEEThemeSPDes.ProductZoom();
          BEEThemeSPDes.PopupMFP();
           if ($parentSection.find('[data-bee-addthis]').length > 0) {
             $script('//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56efaa05a768bd19' , function() {
              addthis.layers.refresh();
             });
           }
           BEEThemeSPDes.Tabs.Default();
           BEEThemeSPDes.Tabs.Accordion();
 
       }
 
       if ($parentSection.hasClass(str_header)) {
 
          var options = JsonParse($parentSection.find('[data-header-options]').attr('data-header-options'));
          if (options.isTransparent) {
             $html.addClass('is--header-transparent');
             document.documentElement.style.setProperty('--header-height', document.querySelector("."+str_header).offsetHeight + 'px');
          } else {
             $html.removeClass('is--header-transparent is--topbar-transparent');
          }
 
          var options2 = JsonParse($(str_top_bar_id).find('[data-topbar-options]').attr('data-topbar-options') || '{}');
          if (options2.isTransparent) {
             $html.addClass('is--topbar-transparent');
             document.documentElement.style.setProperty('--topbar-height', document.getElementById('bee-top-bar-main').offsetHeight + 'px');
          } else {
             $html.removeClass('is--topbar-transparent');
          }
          BEEThemeSPDes.Header.stickyInit();
          BEEThemeSPDes.Header.init( $("[data-menu-nav]>li.has--children") );
          
          // Update header category
          // updateCategories();
          
       // } else if ($parentSection.hasClass(str_categories_cl)) {
       //  //console.log(str_categories_cl)
       //  updateCategories();
       
       } else if ($parentSection.hasClass(str_footer)) {
          BEEThemeSPDes.Footer();
       } else if ($parentSection.hasClass(str_bee_tp_bundles)) {
          BEEThemeSP._initBundlePrs();
          BEEThemeSP.initGroupsProduct();
          BEEThemeSP.ProductAjax.init();
       }
 
       if ( $parentSection.hasClass(str_tp_tab) || $parentSection.hasClass(str_tp_tab3) ) {
          // BEEThemeSPDes.TabsInt();
          BEEThemeSPDes.Tabs.Default();
          BEEThemeSPDes.Tabs.Accordion();
       } else if ( $parentSection.hasClass(str_tp_tab2) ) {
          // BEEThemeSPDes.TabsSimpleInt();
          BEEThemeSPDes.Tabs.Simple();
       // } else if ($parentSection.hasClass(str_tp_tab3)) {
       //    BEEThemeSPDes.TabsInt();
       //    BEEThemeSPDes.AccordionInt();
       } else if ( $parentSection.hasClass(str_bee_tp_ins) ) {
         BEEThemeSPDes.instagram();
       } else if ( $parentSection.is(str_announcement_bar_id) ) {
          // console.log($parentSection)
          if ( $parentSection.find('.bee-announcement-bar').length > 0 ) {
             BEEThemeSP.announcement();
          } else {
          $parentSection.attr("aria-hidden", true);
          }
       }
       
       // update html sidebar
       if ( $parentSection.hasClass(str_sidebar) ) {
 
         var $sidebar_id       = $parentSection.find('[data-sidebar-id]'),
         isDrawerSidebar       = $sidebar_id.is('[data-sidebar-true]'),
         isDrawerSidebarMobile = $sidebar_id.is('[data-is-disableDrawer]'),
         $sidebar              = $('[data-sidebar-content]'),
         responseText          = $parentSection.find('template').html();
       
         BEEThemeSPDes.Drawer.close();
      
          var ArrHtml = responseText.split('[beeplitlz]'),
              ArrHtml2 = ArrHtml[2].split('[beeplitlz2]');
          $sidebar.html( ArrHtml[1] );
          BEEThemeSP.$appendComponent.after( ArrHtml2[0]+ArrHtml[1]+ArrHtml2[1] );
          //$parentSection.find('.bee-drawer:first').attr('id','');
          $('#drawer-'+id).remove();
 
          BEEThemeSPDes.instagram();
          BEEThemeSPDes.Countdown();
          BEEThemeSPDes.Tooltip();
          BEEThemeSP.Tabs.Accordion();
          $body.trigger('currency:update');
          $parentSection.find('[data-drawer-options]:visible').trigger('click.drawer');
           
       } else if ( $parentSection.hasClass(str_main) ) {
 
         BEEThemeSP.Drawer.remove('bee-filter-hidden');
         if ( $('.bee-section-sidebar').length > 0 ) {
            $('.bee-sidebar').html( $('.bee-section-sidebar').find('template').html().split('[beeplitlz]')[1] );       
         }
          
         let $filterArea = $parentSection.find('[data-filter-area]');
         //console.log($parentSection,'yy')
         if ($filterArea.length > 0) {
             // console.log('facets:loaded:adm')
             $document.trigger( 'facets:loaded:adm', [$filterArea, $parentSection] );
         } else {
          // console.log('facets:loaded:admOff')
          $document.trigger('facets:loaded:admOff');
         }
 
         BEEThemeSPDes.instagram();
         BEEThemeSPDes.Countdown();
         BEEThemeSPDes.Tooltip();
         $body.trigger('currency:update');
 
         var dtItems = $('[data-layout-switch]').data('items');
         if (dtItems) {
              var windowWidth = window.innerWidth,
              onlistview      = dtItems.split('.'),
              producSelector  = document.querySelectorAll('#shopify-section-'+id+' .bee-products')[0],
              classListview   = 'is--listview on--list-',
              classListview2  = classListview;
              
              if ( windowWidth < 768 && onlistview[0] == 'list_bee' ) {
                 classListview = classListview +'mobile';
              } else if ( windowWidth < 1025 && windowWidth > 767 && onlistview[1] == 'list_bee' ) {
                 classListview = classListview +'tablet';
              } else if (windowWidth > 1024 && onlistview[2] == 'list_bee') { 
                 classListview = classListview +'desktop';
              }
              if (classListview != classListview2)
              producSelector.className += ' '+classListview;
         }
 
       } else if ($parentSection.hasClass(str_rencent_related) ) {
         BEEThemeSPDes.recentlyViewed();
         BEEThemeSPDes.productRecommendations();
       } else if ( $parentSection.hasClass(str_rencent) ) {
         BEEThemeSPDes.recentlyViewed();
       } else if ( $parentSection.hasClass(str_related) ) {
         BEEThemeSPDes.productRecommendations();
       }
 
   });
   
   // 'shopify:section:unload'
   $document.on(SectionUnloadEvt, function(e){
       var id = e.detail.sectionId,
           $parentSection = $(str_Section_ID + id);
       Bee_console_log(SectionUnloadEvt,$parentSection);
       
       id = sectionMobile($parentSection) || id;
       if ( id == str_mb_nav || id == str_mb_cat || id == str_mini_cart || id == str_login_sidebar ) {
         $('.bee-close-overlay:visible').trigger('click');
       } 
       // else if ( id == str_popups ) {
       //  $.magnificPopupBee.close();
       // }
     
   });
   
   // 'shopify:section:select'
   $document.on(SectionSelectEvt, function(e){
       var id = e.detail.sectionId,
           $parentSection = $(str_Section_ID + id);
       Bee_console_log(SectionSelectEvt,$parentSection);
 
       id = sectionMobile($parentSection) || id;
 
       if ($parentSection.hasClass(str_bk_flickity)) {
         var $owl = $parentSection.find(str_sl_flickity);
         if ($owl.length > 0) { 
           setTimeout(function(){ 
             //BEEThemeSPDes.Flickitybee.init($owl);
             $owl[0].flickitybee = new BEEThemeSPDes.Carousel($owl[0]);
           }, 300); }
       }
 
       if ( id == str_mb_nav || id == str_mb_cat ) {
         $('[data-menu-drawer]:visible').trigger('click');
 
         $('[data-id="#shopify-'+id+'"]').trigger('click');
 
       } else if ( id == str_mini_cart ) {
         $('.bee-site-nav__cart [data-drawer-options]:visible').trigger('click');
       } else if ( id == str_login_sidebar ) {
         $('.bee-site-nav__account [data-drawer-options]:visible').trigger('click');
       // } else if ( id == str_facets || id == str_facets_tags ) {
           
       //     let $filter     = $('#bee-filter-hidden'),
       //         $filterTags = $('#bee-filter-hidden-tags');
           
       //     if (self.$filterArea.length > 0) return;
       //     if ( id == str_facets && $filter.length > 0) {
       //       BEEThemeSP.Drawer.opend($filter)
       //     } else if (id == str_facets_tags && $filterTags.length > 0) {
       //       BEEThemeSP.Drawer.opend($filterTags)
       //     }
       //     // $('.bee-btn-filter:visible').trigger('click');
       
       } else if ( id == str_main_qv || id == str_main_qs) {
         $body.trigger('modalbee:closed');
         setTimeout(function(){
            var data = $parentSection.find('>template').html(),
            prefix     = (id == str_main_qv) ? 'main-qv' : 'main-qs',
            popupClass = (id == str_main_qv) ? 'bee-opening-qv' : 'bee-opening-qs';
            //BEEThemeSP.NTpopupInline(data, str_main_qv, reloadFunctQuickView );
            BEEThemeSP.NTpopupInline(data ,prefix, (id == str_main_qv) ? reloadFunctQuickView : reloadFunctQuickShop, popupClass );
            BEEThemeSPDes.PopupMFP();
            $body.trigger('modalbee:opened');
          }, 500);
       } else if ( id == str_color_cus ) {
          $parentSection.slideDown();
          $("html, body").animate({ scrollTop: $(document).height() + 400 -$(window).height() });
       } else if ( id == str_popups ) {
         $('.bee-popup__sales').hide();
       
       } else if ( $parentSection.hasClass(str_main) ) {
         BEEThemeSP.Drawer.remove('bee-filter-hidden');
 
       } else if ($parentSection.hasClass(str_categories_cl) || $parentSection.hasClass(str_categoriesMain) ) {
 
          if ( $parentSection.hasClass(str_categoriesMain) ) {
             $categoriessMain = $parentSection;
             headerWrapperCategories  = getheaderWrapperCategories();
             // console.log(getheaderWrapperCategories(), headerWrapperCategories, !!headerWrapperCategories, isCheck)
             // setTimeout(() => {
             //   console.log($categoriessMain, !!headerWrapperCategories, isCheck)
             // }, 1000);
             if ( !!headerWrapperCategories ) {
                // console.log('yyy')
                updateCategories( $(headerWrapperCategories) );
             }
 
          } else {
             $headerCategories = $parentSection;
             updateCategories( $(headerWrapperCategories) );
          }
 
       } 
       // else if ( $parentSection.hasClass(str_categories_cl) ) {
       //     $(`.${str_header} .bee-h-cat`).addClass(str_action);
       // }
 
       // if ( $parentSection.hasClass(str_sidebar) ) {
       //     $document.on('sidebar:updated', function(e) {
       //        $('.bee-sidebar').html( $('.bee-section-sidebar').html().split('[beeplitlz]')[1] );
       //     });
       // }
     
   });
   
   // 'shopify:section:deselect'
   $document.on(SectionDeselectEvt, function(e){
       var id = e.detail.sectionId,
           $parentSection = $(str_Section_ID + id);
       Bee_console_log(SectionDeselectEvt,$parentSection);
 
       id = sectionMobile($parentSection) || id;
       
       // Close hidden sidebar
       if ( $parentSection.hasClass(str_sidebar) ) {
          BEEThemeSPDes.Drawer.close();
       }
       
       // if ( id == str_mb_nav || id == str_mb_cat || id == str_mini_cart || id == str_login_sidebar || id == str_facets || id == str_facets_tags ) {
       if ( id == str_mb_nav || id == str_mb_cat || id == str_mini_cart || id == str_login_sidebar ) {
         $('.bee-close-overlay:visible').trigger('click');
       } else if ( id == str_main_qv) {
         $body.trigger('modalbee:closed');
       } else if ( id == str_color_cus) {
          $parentSection.slideUp();
       } else if ( id == str_popups && $.magnificPopupBee.instance.isOpen ) {
          $.magnificPopupBee.close();
 
       } else if ( $parentSection.hasClass(str_categories_cl) ) {
           // console.log($(`.${str_header} .bee-h-cat`))
           $(`.${str_header} .bee-h-cat`).removeClass(str_action);
       }
   });
   
   // 'shopify:block:select'
   $document.on(BlockSelectEvt, function(e){
     var id = e.detail.sectionId, 
         blockId = e.detail.blockId,
           $parentSection = $(str_Section_ID + id),
           $blockId = $('#b_'+blockId);
       Bee_console_log(BlockSelectEvt,$parentSection,$blockId);
 
       id = sectionMobile($parentSection) || id;
       
       if ($parentSection.hasClass(str_bk_flickity)) {
         flickityBlock.select($parentSection,$blockId);
       }
       
       if ( $parentSection.hasClass(str_main_product) ) {
         // console.log( $blockId, $('bee4_'+blockId) );
         if ($blockId.is(':visible')) {
            $('#b_'+blockId+':not(.bee-active)').trigger('click');
         } else {
            $('#bee4_'+blockId+':not(.bee-active)').trigger('click');
         }
 
       } else if ($parentSection.hasClass(str_tp_tab) || $parentSection.hasClass(str_tp_tab2)) {
          $('#b_'+blockId+':not(.bee-active)').trigger('click');
       } else if ($parentSection.hasClass(str_tp_tab3)) {
 
          if ($window.width() > 1024) {
           $('#b_'+blockId+':not(.bee-active)').trigger('click');
          } else {
           $('#b2_'+blockId+':not(.bee-active)').trigger('click');
          }
       } else if ( $parentSection.hasClass(str_bee_tp_lb) ) {
          //console.log( $('[data-pin-popup][data-bid="bee_'+blockId+'"]' ) );
          $('[data-pin-popup][data-bid="bee_'+id+blockId+'"]').trigger('click');
 
       } else if ( $parentSection.hasClass('bee-section-mega__menu') ) {
         var $datablockid = $('[data-blockid="'+blockId+'"]'),
             $blockid  = $parentSection.find('#bk_'+blockId);
 
         if ( $blockid.length > 0 ) {
             $datablockid = $blockid.closest('[data-blockid]');
         }
 
         var $lazyMenu = $('.bee-section-header .bee-lazy_menu[data-id="'+$datablockid.attr('data-id')+'"]');
 
         if ($lazyMenu.length == 0) return;
 
         $lazyMenu.html ( $datablockid.html() );
         $('.bee-section-header').addClass('calc-pos-submenu');
         $lazyMenu.closest('.has--children').addClass(str_action);
         // console.log('aa')
         // console.log($datablockid)
 
       } else if ( $parentSection.hasClass(str_header) ) {
           $('.has--children#item_'+blockId).addClass(str_action);
 
       } else if ( $parentSection.hasClass(str_categories_cl) ) {
           $(`.${str_header} .bee-h-cat`).addClass(str_action);
           var $currentBlock = $('#item_'+blockId);
           if ($currentBlock.length == 0) $currentBlock = $('#bk_'+blockId);
           if ( $currentBlock.hasClass('has--children') ) {
              $currentBlock.addClass(str_action);
           } else {
              //console.log($currentBlock.closest('.has--children'))
              $currentBlock.closest('.has--children').addClass(str_action);
           }
 
       } else if ( id == str_mb_nav || id == str_mb_cat ) {
          $('#bee-menu-drawer #item_'+blockId+'.bee-menu-item-has-children.bee-only_icon_false:not(.is--opend)>a').trigger('click');
          $('#bee-menu-drawer #item_'+blockId+'.bee-menu-item-has-children:not(.is--opend) > a > .bee-mb-nav__icon').trigger('click');
       } else if (id == str_mini_cart ) {
         $('.bee-site-nav__cart [data-drawer-options]:visible').trigger('click');
       // } else if (id == str_login_sidebar ) {
       //   $('.bee-site-nav__account [data-drawer-options]:visible').trigger('click');
       } else if ( id == str_color_cus ) {
         $('#item_'+blockId).addClass("is--selected");
       
       } else if ( id == str_popups ) {
         // console.log('bbbb')
 
         $blockId = $(`[data-block="${blockId}"]`);
         // console.log($blockId)
 
         if ( $.magnificPopupBee.instance.isOpen && !( $blockId.is('#bee-popup__age') || $blockId.is('#bee-popup__exit') || $blockId.is('#bee-popup__newsletter') ) ) {
           // console.log('tttt')
           $.magnificPopupBee.close();
         }
         $blockId.trigger('open.popup');
       }
     
   });
   
   // 'shopify:block:deselect'
   $document.on(BlockDeselectEvt, function(e){
     var id = e.detail.sectionId, 
         blockId = e.detail.blockId,
           $parentSection = $(str_Section_ID + id),
           $blockId = $('#b_'+blockId);
       Bee_console_log(BlockDeselectEvt,$parentSection,$blockId);
 
       id = sectionMobile($parentSection) || id;
       
       if ($parentSection.hasClass(str_bk_flickity)) {
         flickityBlock.deselect($parentSection,$blockId);
       }
       
       if ( $parentSection.hasClass(str_main_product) ) {
         // console.log( $blockId, $('bee4_'+blockId) );
         if ( $blockId.is(':visible') ) {
            $blockId.trigger('click');
         } else {
            $('bee4_'+blockId).trigger('click');
         }
 
       } else if ($parentSection.hasClass(str_tp_tab) || $parentSection.hasClass(str_tp_tab2)) {
          $('#b_'+blockId+'.bee-active').trigger('click');
       } else if ($parentSection.hasClass(str_tp_tab3)) {
 
          if ($window.width() > 1024) {
           $('#b_'+blockId+'.bee-active').trigger('click');
          } else {
           $('#b2_'+blockId+'.bee-active').trigger('click');
          }
       } else if ( $parentSection.hasClass(str_bee_tp_lb) ) {
           $('[data-pin-popup][data-bid="bee_'+id+blockId+'"]').trigger('click');
       } else if ( $parentSection.hasClass('bee-section-mega__menu') ) {
         var $datablockid = $('[data-blockid="'+blockId+'"]'),
             $blockid  = $parentSection.find('#bk_'+blockId);
 
         if ( $blockid.length > 0 ) {
             $datablockid = $blockid.closest('[data-blockid]');
         }
 
         var $lazyMenu = $('.bee-section-header .bee-lazy_menu[data-id="'+$datablockid.attr('data-id')+'"]');
 
         if ($lazyMenu.length == 0) return;
 
         $lazyMenu.closest('.has--children').removeClass(str_action);
       } else if ( $parentSection.hasClass(str_header) ) {
           $('.has--children#item_'+blockId+'.'+str_action).removeClass(str_action);
 
       } else if ( $parentSection.hasClass(str_categories_cl) ) {
           //$(`.${str_header} .bee-h-cat`).removeClass(str_action);
           var $currentBlock = $('#item_'+blockId);
           if ($currentBlock.length == 0) $currentBlock = $('#bk_'+blockId);
           if ( $currentBlock.hasClass('has--children') ) {
              $currentBlock.removeClass(str_action);
           } else {
              $currentBlock.closest('.has--children').removeClass(str_action);
           }
 
       } else if ( id == str_mb_nav || id == str_mb_cat ) {
          $('#bee-menu-drawer #menu-mb__ul >.bee-only_icon_false.is--opend>a').trigger('click');
          $('#bee-menu-drawer #menu-mb__ul >.is--opend> a > .bee-mb-nav__icon').trigger('click');
       } else if (id == str_mini_cart ) {
         $('.bee-close-overlay:visible').trigger('click');
       } else if ( id == str_color_cus) {
         $('#item_'+blockId).removeClass("is--selected");
       } else if ( id == str_popups) {
          // bee-popup__age  bee-popup__cookies-law
         $blockId = $(`[data-block="${blockId}"]`);
         // console.log('dddd')
         // console.log($blockId)
         if ( $blockId.is('#bee-popup__age') || $blockId.is('#bee-popup__exit') || $blockId.is('#bee-popup__newsletter') ) {
           // console.log('$blockId mfp')
           if ( !$.magnificPopupBee.instance.isOpen ) {
              $blockId.trigger('close.popup');
           } 
         } else {
           // console.log('$blockId not mfp')
           $.magnificPopupBee.close();
           $blockId.trigger('close.popup');
         }
       }
     
 
   });
 
    
    function BackToTop() {
          // console.log('back to top')
          var $backToTop = $('#bee-backToTop'),
          scrollTop = parseInt($backToTop.data('scrolltop')),
          debounce_timer,
          debounce_timer2,
          $backToTop,
          circlechart = $backToTop.find('.bee-circle-css')[0];
 
          if ( ( $window.width() < 768 && $backToTop.data('hidden-mobile') ) || $backToTop.length == 0 ) return;
 
          window.addEventListener("scroll", () => {
 
             if (debounce_timer) { clearTimeout(debounce_timer); }
 
             debounce_timer = setTimeout(function() {
                if (window.scrollY > scrollTop) {
                     $backToTop.addClass('is--show');
                } else {
                     $backToTop.removeClass('is--show');
                }
             }, 40);
             
             if ( !circlechart ) return;
 
             if (debounce_timer2) { clearTimeout(debounce_timer2); }
 
             debounce_timer2 = setTimeout(function() {
 
                let scrollTop2 = window.scrollY,
                docHeight  = document.body.offsetHeight,
                winHeight  = window.innerHeight,
                scrollPercent = scrollTop2 / (docHeight - winHeight),
                scrollPercentRounded = Math.round(scrollPercent * 100),
                degrees = scrollPercent * 360;
                //percentLabel.innerHTML = scrollPercentRounded;
                // console.log(scrollPercentRounded);
                //BEEThemeSP.CircleChart.update(circlechart, scrollPercentRounded);
                circlechart.style.setProperty("--cricle-degrees", degrees + 'deg');
                //circlechart.style.setProperty("--cricle-percent", scrollPercentRounded + '%');
             }, 6);
 
          });
 
          //if (!IsDesignMode) RunjsBackToTop = true;
 
      };
 
    function updateCategories($headerWrapperCategories) {
      
      if ($categoriessMain.length == 0 || $headerCategories.length == 0) return;
      //console.log('updateCategories', $headerCategories)
      BEEThemeSPDes.Header.updateCat( $headerCategories.html(), $headerWrapperCategories )
    };
 
 
    function reloadFunctQuickView() {
        // main-qv - Quickview Refresh
        var data_product = 'data-product-featured',
            class_enabled = 'initProducts__enabled',
            $quickView   = $('.bee-product-quick-view'),
            $this =        $quickView.find('['+data_product+']:not(.'+class_enabled+')');
 
       $this.addClass(class_enabled);
       new BEEThemeSPDes.Product( $this );
 
       var $mainMedia = $quickView.find('[data-main-media]');
 
       if ( $mainMedia.hasClass('flickitybee') && !$mainMedia.hasClass('flickitybee-enabled') ) {
         //BEEThemeSP.Flickitybee.init($mainMedia);
         $mainMedia[0].flickitybee = new BEEThemeSPDes.Carousel($mainMedia[0]);
       }
 
        BEEThemeSPDes.PopupMFP();
 
        if (window.Shopify && Shopify.PaymentButton) {
           Shopify.PaymentButton.init();
        }
 
        if ($parentSection.find('[data-bee-addthis]').length > 0) {
          $script('//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-56efaa05a768bd19' , function() {
           addthis.layers.refresh();
          });
        }
    };
 
    function reloadFunctQuickShop() {
       // console.log('reloadFunctQuickShop')
         // main-qv - Quickview Refresh
       var data_product = 'data-product-featured',
       class_enabled    = 'initProducts__enabled',
       $quickView       = $('.bee-product-quick-shop:not(.'+class_enabled+')'),
       $this            =        $quickView;
 
       $this.addClass(class_enabled);
       new BEEThemeSPDes.Product( $this[0] );
 
       // var $mainMedia = $quickView.find('[data-main-media]');
 
       // if ( $mainMedia.hasClass('flickitybee') && !$mainMedia.hasClass('flickitybee-enabled') ) {
       //  //BEEThemeSP.Flickitybee.init($mainMedia);
       //  $mainMedia[0].flickitybee = new BEEThemeSP.Carousel($mainMedia[0]);
       // }
 
       BEEThemeSPDes.PopupMFP();
       // BEEThemeSP.initGroupsProduct();
 
      if (window.Shopify && Shopify.PaymentButton) {
         Shopify.PaymentButton.init();
      }
   };
   
 })(jQuery_BENT);
 
jQuery_BENT(document).ready(function ($) {
    
    $('html').addClass('bee-shopify-des-adm');
    $('body').append('<style id="bee-shopify-des-adm-style">.bee-shopify-des-adm body {width: 100vw;}</style>');
 
    /**
     * Button tool on admin
     */
    $('.bee_tools_btns').addClass('on_show');
    $(document).on('click', '.admin_bee_tools_btn', function(e) {
       $(this).toggleClass('show_admin_bee_pp')
    });
})